{% extends "_base/class.html.jinja" %}

{% block contents %}
  {% block bases %}{{ super() }}{% endblock %}
  {% block docstring %}{{ super() }}{% endblock %}

  {% block schema scoped %}
    {% if class.extra.griffe_pydantic.schema %}
      <details><summary>Show JSON schema:</summary>
        {{ class.extra.griffe_pydantic.schema | highlight(language="json") }}
      </details>
    {% endif %}
  {% endblock schema %}

  {% block config scoped %}
    {% if class.extra.griffe_pydantic.config %}
      <p>Config:</p>
      <ul>
        {% for name, value in class.extra.griffe_pydantic.config.items() %}
          <li><code>{{ name }}</code>: {{ value|string|highlight(language="python", inline=True) }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endblock config %}

{% block fields scoped %}
  {% with fields = class.extra.griffe_pydantic._stored_fields or class.extra.griffe_pydantic.fields() %}
      {% if fields %}
        <p><strong>Fields:</strong></p>
        <div class="pydantic-field-spacy">
          <div class="pydantic-field-header">
            <div class="field-name">Name</div>
            <div class="field-content">Description</div>
          </div>
          {% for name, field in fields.items() %}
            <div class="pydantic-field-item">
              <div class="field-name">
                <code><autoref optional hover identifier="{{ field.path }}">{{ name }}</autoref></code>
              </div>
              <div class="field-content">
                {% if field.docstring %}
                  <div class="field-description">
                    {% with autoref_hook = AutorefsHook(field, config) %}
                      {{ field.docstring.value|convert_markdown(heading_level, field.path, autoref_hook=autoref_hook) }}
                    {% endwith %}
                  </div>
                {% endif %}
                <div class="field-meta">
                  <span class="field-type"><strong>TYPE:</strong> {% with expression = field.annotation %}<code>{% include "expression.html.jinja" with context %}</code>{% endwith %}</span>
                  <span class="field-default"><strong>DEFAULT:</strong>
                    {% if field.extra.vizro_pydantic and field.extra.vizro_pydantic.default_display is not none %}
                      <code>{{ field.extra.vizro_pydantic.default_display }}</code>
                    {% elif field.extra.vizro_pydantic and field.extra.vizro_pydantic.required %}
                      <em>required</em>
                    {% elif field.value is not none %}
                      {{ field.value|string|highlight(language="python", inline=True) }}
                    {% else %}
                      <em>required</em>
                    {% endif %}
                  </span>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
  {% endblock fields %}

{% block validators scoped %}
  {# Validators are intentionally not displayed in API docs #}
{% endblock validators %}

  {% block source %}{{ super() }}{% endblock %}
  {% block children %}{{ super() }}{% endblock %}
{% endblock contents %}
