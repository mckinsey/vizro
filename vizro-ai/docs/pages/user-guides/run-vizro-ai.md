# Run Vizro-AI

This guide offers insights into different ways of running Vizro-AI code, including within a Jupyter Notebook, as a Python script, or through integration into an application.

## Jupyter Notebook
To run Vizro-AI code in a Jupyter Notebook, create a new cell and execute the code below to render the described visualization as output.

??? note "Note: API key"

    Make sure you have followed the [LLM setup guide](../user-guides/install.md#set-up-access-to-a-large-language-model) and thatyour api key is set up in a `.env` file in the same folder as your Notebook file (`.ipynb`).

!!! example "Ask Vizro-AI to generate a bar chart"

    === "Code for the cell"
        ```py
        import vizro.plotly.express as px
        from vizro_ai import VizroAI

        vizro_ai = VizroAI()

        df = px.data.gapminder()
        fig = vizro_ai.plot(df, "visualize the life expectancy per continent and color each continent")
        fig.show()
        ```
    === "Result"
        [![BarChart]][BarChart]

    [BarChart]: ../../assets/user_guides/bar_chart_gdp_per_continent.png

Note that if you run this code, its appearance may not precisely resemble the one displayed, as it is generated by a generative AI and can vary.

## Python script
You can use Vizro-AI in any standard development environment by creating a `.py` file and executing the code, which displays the output in a browser window.

??? note "Note: API key"

    Make sure you have followed [LLM setup guide](../user-guides/install.md#set-up-access-to-a-large-language-model) and that your API key is set up in the environment where your `.py` script is running with command as below:

    ```bash
    export OPENAI_API_KEY="your api key"
    ```

!!! example "Ask Vizro-AI to generate a line chart"

    === "example.py"
        ```py
        import vizro.plotly.express as px
        from vizro_ai import VizroAI

        vizro_ai = VizroAI()

        df = px.data.gapminder()
        fig = vizro_ai.plot(df, "describe life expectancy per continent over time")
        fig.show()
        ```
    === "Result"
        [![LineChart]][LineChart]

    [LineChart]: ../../assets/user_guides/line_chart_life_expect.png

## Application integration

You may prefer to integrate Vizro-AI into an application that offers a UI for users to input prompts.

There are two ways to integrate Vizro-AI into an application: directly and by accessing the chart code behind a `fig` object.

1. Vizro-AI's `plot` method returns a `plotly.graph_objects` object (`fig`) that can be used directly within a `Vizro` dashboard.

    !!! example "Direct application integration"

        === "app.py"
            ```py
            import vizro.plotly.express as px
            from vizro_ai import VizroAI

            vizro_ai = VizroAI()

            df = px.data.gapminder()
            fig = vizro_ai.plot(df, "describe life expectancy per continent over time")
            ```


2. Vizro-AI's `_get_chart_code` method returns a string of Python code that manipulates the data and creates the visualization. Vizro-AI validates the code to ensure that it is executable and can be integrated.

    !!! example "Application integration via chart code"

        === "app.py"
            ```py
            import vizro.plotly.express as px
            from vizro_ai import VizroAI

            vizro_ai = VizroAI()

            df = px.data.gapminder()
            code_string = vizro_ai._get_chart_code(df, "describe life expectancy per continent over time")
            ```
        === "code_string"
            [![ResultCode]][ResultCode]

        [ResultCode]: ../../assets/user_guides/code_string_app_integration.png

The `code_string` returned can be used to dynamically render charts within your application. You may have the option to encapsulate the chart within a `fig` object or convert the figure into a JSON string for further integration.

To use the insights or code explanation, you can use `vizro_ai._run_plot_tasks(df, ..., explain=True)`, which returns a dictionary containing the code explanation and chart insights alongside the code.
